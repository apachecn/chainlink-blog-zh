# 通过 Chainlink 使用可信计算框架和认证 Oracles 推动对企业智能合同的需求

> 原文:[https://blog . chain . link/driving-demand-for-enterprise-smart-contracts-using-the-trusted-computing-framework-and-estated-Oracle-via-chain link/](https://blog.chain.link/driving-demand-for-enterprise-smart-contracts-using-the-trusted-computation-framework-and-attested-oracles-via-chainlink/)

*由英特尔系统架构师兼 TCF 技术负责人 Eugene Yarmosh 和 [Chainlink Lab](https://chainlinklabs.com/) 团队共同撰写。*

通过使用 chain link[Oracle](https://chain.link/education/blockchain-oracles)将事务性计算离线路由到可信计算框架(TCF ),区块链可以大大增强其满足企业隐私和可伸缩性要求的能力。

为了更好地理解这种新设计模式的重要性，正如英特尔最近发表的名为" *[的博客文章所述，Hyperledger Avalon 可信计算框架](https://software.intel.com/en-us/articles/new-confidential-computing-solutions-emerge-on-the-hyperledger-avalon-trusted-compute)上出现了新的机密计算解决方案，*我们讨论了公共区块链的优势和局限性，并概述了 TCF 架构以及通过 Chainlink 认证的 oracles 如何实现链上和链下环境之间的双向连接。为了演示该系统如何工作，我们详细介绍了金融、[保险](https://blog.chain.link/blockchain-insurance/)和全球贸易中的三个行业用例，其中 TCF、Chainlink 和底层区块链可以协同工作，以改善后端业务流程并降低企业和消费者的成本。

## 公共区块链网络上分布式计算的优势和局限性

以太坊[智能合约](https://chain.link/education/smart-contracts)正在重塑支持多方交易合约的基础设施。它们提供了一个共享的计算平台，为所有相关方存储、维护、执行和结算合同。一旦合同在区块链启动，参与方既不能解除义务，也不能篡改进程。

智能合同不是信任交易对手或依赖可信的第三方来手动验证合同事件，而是将合同条款转换为基于数据输入触发的计算机代码。例如，智能[衍生品](https://blog.chain.link/solving-deep-seated-trust-problems-in-derivatives-using-chainlink-enabled-smart-contracts/)合约可以由[市场数据](https://feeds.chain.link/)自动触发，而贸易支付可以取决于确认货物安全到达的物联网传感器。数据驱动的智能合约通过减少人工和跨网络摩擦，为涉及多方工作流的外部业务流程自动化提供了最佳解决方案之一。

公共区块链提供了很高操作透明度和防篡改的执行，但是在隐私和可伸缩性方面有明显的限制。这两个限制严重阻碍了区块链的开发和采用，尤其是在企业级，从内部和法律的角度来看，高吞吐量和事务隐私都是强制性的。

另一个主要问题是连接性——区块链只能对已经存储在区块链中的数据进行计算。使用以太坊区块链作为中央数据库来存储推动全球经济所需的大量数据是一个不切实际的解决方案。存在旨在扩展网络速度和降低成本的链上扩展提议，但是许多提议目前正在开发中，并且仍然存在关于它们满足企业需求的能力的主要问题。

与其试图在链上解决这些问题，不如寻找链外解决方案。一个这样的提议是将链外事务计算卸载到 TCF，并通过实现 [Town Crier](https://eprint.iacr.org/2016/168.pdf) 在可信执行环境(TEE)中使用 Chainlink 神谕，作为链上和链外环境之间通信的可信双向桥梁。

## 介绍可信计算框架及其价值主张

可信计算框架(TCF)通过将计算密集型和私有数据处理移至链外，解决了区块链的可扩展性和隐私挑战。其他类似的方法通常以弹性和完整性换取可伸缩性和隐私。TCF 通过使用 TEE 来确保链外计算正确安全地完成，从而避免了这种折衷。

让我们首先探索一下链外执行的好处:

*   离线智能合同处理比传统的区块链交易更高效，因为它不需要在每个区块链节点重复执行
*   高容量交易可以在链外进行调节，例如，仓库温度传感器流可以在链外进行预处理，每天只在链上记录一次平均、最低和最高温度，而不是记录整个原始温度数据流
*   复杂的处理，如视频或基因组学的人工智能，可以离线处理(例如，由于 EVM 的限制)，结果可以在链上记录
*   灵活的隐私政策可以在链外实施，以强制在链上和与哪些参与者共享什么和多少信息
*   在许多情况下，由于隐私法规的原因，即使加密，数据也不能放在链上，尤其是如果区块链网络分布在多个地理位置。在某些情况下，脱机执行是处理这些数据的唯一选择
*   如果没有某种形式的链外代理，现有企业遗留应用程序和外部数据源的集成通常是不切实际的

链外执行本身对分散计算的价值有限，因为它不支持计算信任——这是任何区块链的一个关键区别。计算信任假设使用计算机处理来建立交易的有效性，而不是使用机构或中介。

TCF 通过使用可信执行环境(TEE)来解决这一问题，例如英特尔 SGX，用于链外执行。 [Town Crier](https://blog.chain.link/town-crier-and-chainlink/) 还利用球座，创造了几个让它们成为区块链理想伴侣的属性:

*   **工作负载隔离**。TEE 具有特殊的属性，允许它将其工作负载执行与所有不可信的软件(包括操作系统内核)隔离开来。因此，即使是平台所有者(例如云服务器提供商)也无法访问 TEE 正在处理的数据。
*   **三通认证**。TEE 可以提供证明验证报告，证明提交的工作负载将在具有适当硬件功能的平台上执行，平台的可信计算基础(操作码、固件)是最新的，并且只有授权的算法将用于执行工作负载。
*   **政策执行**。TCF 利用 TEE 隔离和证明来实现确保数据机密性和完整性的功能，并提供可存储在链上的有效工作负载执行的加密证明。来自多个源的数据可以由相应的数据所有者独立加密，仅在 TEE 中以解密形式处理，并在处理后丢弃。

通过使用 TEE，TCF 将区块链计算信任的好处扩展到了数据、传感器和计算能力等链外资产。如果本节开头定义的用例在 TCF 环境中执行，它们将成为分散计算的自然延伸。

TCF 是一个提供基线离线可信计算能力的框架，可用于构建各种分散式应用。使用 Town Crier 的 TEEs 方法的 TCF 和 [Chainlink](https://chain.link/) 的组合，为构建需要可信和可验证的外部数据源(也称为认证神谕)的解决方案提供了一个强大的基础。

## 可信计算框架的技术概述

下图从较高的层面描绘了 TCF 建筑。蓝色组件描述了大多数应用的通用功能。橙色显示的组件描述了特定于应用的功能。智能合约被描述为两种颜色的混合，因为一些 dApps 可能会按原样使用基线实现，而其他 dApps 可能会替换或扩展它。

<figure id="attachment_545" aria-describedby="caption-attachment-545" style="width: 624px" class="wp-caption aligncenter">![A high-level overview of the Trusted Computation Framework (TCF) architecture](../Images/b0e32aa554c9a07152de767195d03509.png)

<figcaption id="caption-attachment-545" class="wp-caption-text">A high-level overview of the Trusted Computation Framework (TCF) architecture</figcaption>

</figure>

可信计算服务(TCS)托管可信工作人员，例如英特尔 SGX 飞地，并使其可用于执行工作指令(WO)。在工作进程初始化期间，TCS 联系外部证明服务(例如英特尔认证服务–IAS)以生成工作进程的证明验证报告。TCS 维护一个工作指令队列，并安排工作指令由适当的工人执行。

此外，TCS 为 worker 中的工作负载提供了一个可插拔的 API，以便在执行过程中安全地访问外部数据源。因此，提交的 WO 请求可能包含请求中嵌入的输入数据，或者可能包含用于外部访问数据的参考(如 URI)。后者在大型数据集、动态数据或必须遵守严格隐私要求的数据的情况下特别有用。这同样适用于 WO 输出数据。

通过智能合约访问 TCS 被称为代理模型，因为区块链充当代理。或者，请求者可以通过 HTTP 侦听器直接与 TCS 交互(也称为直接模型)。此连接选项是对代理模型的补充，它提供(几乎)相同的接口，但其预期用途是支持特定的应用程序要求，例如，高 WO 请求率或不允许在区块链上共享数据的隐私策略。

应当指出，TCF 采取基于标准的方法。它的 API 和实现兼容并基于企业以太坊联盟(EEA)定义的离线可信计算规范。

工作订单由请求者提交，例如最终用户前端 UI(如图所示)，或(特定于企业应用程序的)智能合同、遗留应用程序或外部数据源适配器。

申请人可以通过区块链上的 TCF 智能合同访问 TCS，该合同提供以下功能:

*   注册表列表，带有系统中工作注册表的入口点
*   TCS 使用工人注册表(通常每个 TCS 一个)来列出其工人，请求者使用工人注册表来查找和验证合适的工人
*   用于安排 WO 请求和取回结果的工作单队列
*   用于维护工单执行的加密证明的工单接收日志

TCF 设计假设它是一个开放的系统，作为一个更广泛的解决方案的一部分，与其他框架和库一起使用。这使得它非常适合与 Chainlink 集成，以交付依赖于已证明的和分散的 oracles 的使用(如图所示)。

## 通过 Chainlink Oracles 桥接链上和链下环境

一个 [oracle](https://blog.chain.link/what-is-the-blockchain-oracle-problem/) 是一个数字代理，它被一个智能合同雇佣来检索和/或将它连接到其本地区块链之外的数据和系统(离线)。Oracles 通过重新格式化外部连接点(API)来实现智能合约的链外连接，以便两个不同的软件应用程序兼容进行数据交换。然后，oracles 可以根据服务级别协议(SLA)中概述的预定义指令和端点将数据拉入智能合同和/或推出数据。

![An image showing how Chainlink connects to real-world inputs and outputs. ](../Images/efbda684b60a1c78fb171450d97c54ad.png)

Chainlink 是一个分散式 oracle 网络，可让智能合约安全可靠地访问数据提供商、web APIs、企业系统、云提供商、物联网设备、支付系统、其他区块链等。它具有以下特点:

1.  一个强大的独立预言市场提供了一系列的数据和联系
2.  灵活定制 oracle 连接，包括 Oracle 的数量、数据源的类型和数量、聚合策略、堆栈存储、可信执行环境、混合环境等等
3.  基于链上度量的 oracles 信誉评估框架

这是一个一体化的网络，用户可以使用不同级别的去中心化、数据聚合和 oracle 选择来定制他们的合同如何与链外的任何东西进行通信。

如果没有良好的数据和可靠的连接，在区块链或 TCF 上运行的契约逻辑将产生错误的结果，尽管它们是安全的并且正常运行。Chainlink 为 TCF 提供可信连接，用于输入数据以执行合同，并连接到外部网络以转发输出数据以进行合同结算。它还可以将来自 TCF 的证明转发到区块链，以证明计算是正确的，从而促使为所有各方生成带有时间戳的加密收据。

下面是两个图表，突出了该过程如何工作的基本架构。在第一个图中，查询链上合同为 TCF 创建了一个完成工作订单的请求。Chainlink 节点的任务是在两个环境之间路由消息，并检索执行可能需要的外部 API。

<figure id="attachment_549" aria-describedby="caption-attachment-549" style="width: 960px" class="wp-caption aligncenter">![How to relay a work order request and API via Chainlink Nodes to the TCF](../Images/5f6fab65fa81bc4dc747772f8baef774.png)

<figcaption id="caption-attachment-549" class="wp-caption-text">How to relay a work order request and API via Chainlink Nodes to the TCF</figcaption>

</figure>

在第二个图中，TCF 根据工作订单的完成情况向链上合同返回一个结果。消费响应可以是完成的证明，或者触发来自链上契约的进一步动作，例如某种类型的结算。

<figure id="attachment_551" aria-describedby="caption-attachment-551" style="width: 960px" class="wp-caption aligncenter">![How to use Chainlink Nodes to relay an output from the completed TCF work order to the consuming smart contract](../Images/136ff1cd3d388ff18887c8c78ed66556.png)

<figcaption id="caption-attachment-551" class="wp-caption-text">How to use Chainlink Nodes to relay an output from the completed TCF work order to the consuming smart contract</figcaption>

</figure>

现在已经了解了整个架构，让我们来看看三个主要行业，通过 TCF 设计的智能合同可以提高后端流程的运营效率，并为额外的收入流开辟全新的业务模式。

## 金融

[分散金融(DeFi)](https://chain.link/education/defi) 是公共区块链增长最快的用例之一。它使用智能合约来促进一个强大的市场，用户可以借出、借入自己的钱并产生利息，以及下注和增加/减少资产和事件的风险，所有这些都没有中央协调器。虽然零售市场可能接受公共智能合同上的 DeFi 应用程序，但它目前不适用于企业领域。企业级金融受到高度监管，受制于数据安全法，并需要获得法定货币和定制才能真正繁荣。

TCF 提供了一个安全的环境，各方可以签订各种衍生品合约，合约中的所有条款都是完全保密的。这对场外衍生品尤其有吸引力，在场外衍生品中，头寸规模非常大，信息滑动会破坏投资优势。TCF 还提供离线计算，以在最终结算前实现高吞吐量和低成本的合同更新。Chainlink oracles 可以传递执行所需的基本市场数据，向监管机构和存储库发送元数据，并将合同连接到各种支付轨道进行结算。

## 保险

保险是一个价值数万亿美元的全球性行业，由企业和个人管理风险的需求驱动。鉴于对保险索赔意见不一的倾向，保险公司和保单持有人通常处于不信任的境地，保单持有人过度报告正面属性以获得有利的费率，保险公司提高保费以应对欺诈。通过将策略从基于信任的手动验证模式转移到直接通过数据自动处理索赔的共享基础架构，保险业可以节省后端成本，同时重建消费者的信任。尽管公共区块链提供了防篡改的计算，但它们缺乏有效的机制来隐藏关于保单细节、支出和事件数据的敏感数据。

TCF 隐藏处理索赔和解决合同所需的机密执行细节，而 Chainlink oracles 提供详细描述事件和决定结果的重要数据。Chainlink 使 TCF 能够访问嵌入式物联网传感器(在贸易路线、机械、个人设备、智能电网等中)、跟踪事件数据(航班、天气、网络正常运行时间)的 Web APIs 和 KYC 服务，以准确地将索赔与身份联系起来。与昂贵的链上计算相比，TCF 提供了低成本的处理，这使得更频繁的数据测量成为可能，例如关于驾驶指标的每日报告，以确定汽车保险折扣。Chainlink 还可以[将重要的保险元数据](https://blog.chain.link/blockchain-insurance/)传递给研究人员，向区块链提供证明，并将支出连接到外部支付系统进行结算。

## 全球贸易

随着世界经济通过国际贸易变得更加相互关联，全球化正在快速发展。全球贸易涉及几个组成部分——供应链、贸易融资和监管——以成功地将产品从一个地方转移到另一个地方，并产生结算支付。这些过程中的每一个都依赖于对数据的访问，并且在许多情况下依赖于对敏感数据的访问。例如，供应链和贸易金融公司需要访问物联网传感器、网络数据和支付系统来跟踪商品并进行支付，而监管机构需要整个贸易路线中的交易和产品元数据来确保合规性。

TCF 提供了一个计算引擎来处理全球贸易合同，这些合同保留了用于跟踪和维护质量控制的机密物联网、GPS 和网络数据，以及所使用的商业逻辑。重要的是，公司要隐藏这些数据和逻辑，以避免它们被腐败、被竞争对手窃取或被领先竞争的外部实体利用。TCF 还可以通过仅向每个相关实体提供完成其目标所需的信息来划分合同中涉及的数据。Chainlink oracles 充当可信桥梁，将物联网、Web 和 ERP 数据纳入智能合同，并以外部支付、生成区块链收据的证明和监管机构的元数据的形式发送数据。

## 公共和私有计算环境之间的互联共识

通过 TCF 利用私有和可扩展的链外计算，并通过 Chainlink 实现链外连接，区块链可以专注于真理仲裁的核心效用，同时仍然满足企业的需求。通过新的 TCF 设计，遗留系统可以在区块链网络上构建下一代智能合约应用，而无需改造后端系统。它开辟了一个全新的领域，为开发人员提供定制 Dapp 设计的工具，而不是局限在一个单一的框架中。下一波创新不是决定链上还是链下，或者公有还是私有，而是这些系统的协作，为开发者提供跨不同环境无缝连接的选项。